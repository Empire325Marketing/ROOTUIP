let savingsChart,comparisonChart,calculationData={};const industryBenchmarks={importer:{ddRate:.024,manualHours:180,errorRate:.04,disputeSuccessRate:.67},manufacturer:{ddRate:.018,manualHours:150,errorRate:.035,disputeSuccessRate:.7},"3pl":{ddRate:.032,manualHours:240,errorRate:.045,disputeSuccessRate:.65},carrier:{ddRate:.015,manualHours:120,errorRate:.025,disputeSuccessRate:.75},other:{ddRate:.024,manualHours:180,errorRate:.04,disputeSuccessRate:.67}},uipMetrics={ddReduction:.87,automationRate:.85,errorReduction:.9,disputeSuccessRate:.94,implementationDays:14,yearlyGrowth:.15};function initializeSliders(){const t=document.getElementById("vesselSlider"),e=document.getElementById("vesselCount");t.addEventListener("input",function(){e.value=this.value,calculateROI()}),e.addEventListener("input",function(){t.value=Math.min(100,this.value),calculateROI()});const a=document.getElementById("dataSourcesSlider"),n=document.getElementById("dataSources");a.addEventListener("input",function(){n.value=this.value,calculateROI()}),n.addEventListener("input",function(){a.value=Math.min(20,this.value),calculateROI()})}function initializeEventListeners(){document.getElementById("advancedToggle").addEventListener("click",function(){const t=document.getElementById("advancedOptions");t.classList.contains("open")?(t.classList.remove("open"),this.classList.remove("open")):(t.classList.add("open"),this.classList.add("open"))});document.querySelectorAll('input[type="number"], select').forEach(t=>{t.addEventListener("input",calculateROI),t.addEventListener("change",calculateROI)}),document.getElementById("resultsForm").addEventListener("submit",handleFormSubmission),document.getElementById("downloadReport").addEventListener("click",generatePDFReport),document.getElementById("shareResults").addEventListener("click",shareResults)}function calculateROI(){const t=document.getElementById("industryType").value,e=parseInt(document.getElementById("vesselCount").value)||10,a=parseInt(document.getElementById("containersPerVessel").value)||5e3,n=parseFloat(document.getElementById("ddCharges").value)||12e5,o=parseInt(document.getElementById("manualHours").value)||160,l=parseInt(document.getElementById("dataSources").value)||8,i=(parseFloat(document.getElementById("avgDelayDays").value),parseFloat(document.getElementById("disputeSuccessRate").value)/100||.67),s=parseFloat(document.getElementById("avgHourlyRate").value)||65,r=industryBenchmarks[t],c=e*a,u=12*n,d=u*uipMetrics.ddReduction,m=.13*u*(uipMetrics.disputeSuccessRate-i),g=d+m,y=52*o,p=y*uipMetrics.automationRate,v=p*s,D=250*(c*r.errorRate-c*(r.errorRate*(1-uipMetrics.errorReduction))),h=15*c*(l/10),C=D+h,I=g+v+C,x=5e5*e,b=(I-x)/x*100,E=x/I*365;let R=0;for(let t=1;t<=5;t++)R+=I*Math.pow(1+uipMetrics.yearlyGrowth,t-1);R-=5*x;const S=Math.min(1,l/10);calculationData={annualSavings:I,totalDDSavings:g,laborSavings:v,totalEfficiencyGains:C,annualInvestment:x,roi:b,paybackDays:E,fiveYearValue:R,confidenceInterval:5+15*(1-S),preventableCharges:d,improvedDisputeRecovery:m,automatedHours:p,errorReductionSavings:D,processingTimeSavings:h,annualDDCharges:u,annualManualHours:y,vessels:e,totalContainers:c,benchmark:r,weeklyManualHours:o},updateResults(),updateCharts(),updateBenchmarks()}function updateResults(){const t=t=>t>=1e6?"$"+(t/1e6).toFixed(1)+"M":t>=1e3?"$"+(t/1e3).toFixed(0)+"K":"$"+t.toFixed(0);document.getElementById("annualSavings").textContent=t(calculationData.annualSavings),document.getElementById("fiveYearValue").textContent=t(calculationData.fiveYearValue),document.getElementById("roiPercentage").textContent=calculationData.roi.toFixed(0)+"%",document.getElementById("confidenceInterval").textContent="±"+calculationData.confidenceInterval.toFixed(0)+"%",calculationData.paybackDays<365?document.getElementById("paybackPeriod").textContent=calculationData.paybackDays.toFixed(0)+" days":document.getElementById("paybackPeriod").textContent=(calculationData.paybackDays/365).toFixed(1)+" years",document.getElementById("currentDDExposure").textContent=t(calculationData.annualDDCharges),document.getElementById("preventableCharges").textContent=t(calculationData.preventableCharges),document.getElementById("annualDDSavings").textContent=t(calculationData.totalDDSavings),document.getElementById("currentManualHours").textContent=calculationData.annualManualHours.toLocaleString()+" hrs/year",document.getElementById("automatedHours").textContent=calculationData.automatedHours.toFixed(0)+" hrs/year",document.getElementById("annualLaborSavings").textContent=t(calculationData.laborSavings),document.getElementById("errorReduction").textContent=t(calculationData.errorReductionSavings),document.getElementById("processingGains").textContent=t(calculationData.processingTimeSavings),document.getElementById("annualEfficiencyGains").textContent=t(calculationData.totalEfficiencyGains);const e=document.getElementById("annualSavings");e.classList.remove("pulse"),calculationData.roi>200&&setTimeout(()=>e.classList.add("pulse"),100)}function initializeCharts(){const t=document.getElementById("savingsChart").getContext("2d");savingsChart=new Chart(t,{type:"line",data:{labels:["Year 1","Year 2","Year 3","Year 4","Year 5"],datasets:[{label:"Cumulative Savings",data:[],borderColor:"#00D4AA",backgroundColor:"rgba(0, 212, 170, 0.1)",borderWidth:3,tension:.4,fill:!0},{label:"Investment",data:[],borderColor:"#FF6B35",borderWidth:2,borderDash:[5,5]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:function(t){let e=t.parsed.y;return e>=1e6?t.dataset.label+": $"+(e/1e6).toFixed(1)+"M":t.dataset.label+": $"+(e/1e3).toFixed(0)+"K"}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(t){return t>=1e6?"$"+(t/1e6).toFixed(0)+"M":"$"+(t/1e3).toFixed(0)+"K"}}}}}});const e=document.getElementById("comparisonChart").getContext("2d");comparisonChart=new Chart(e,{type:"bar",data:{labels:["D&D Charges","Manual Hours","Error Rate","Dispute Success"],datasets:[{label:"Current State",data:[],backgroundColor:"#E2E8F0",borderColor:"#CBD5E1",borderWidth:1},{label:"With UIP",data:[],backgroundColor:"#00D4AA",borderColor:"#00B894",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}},scales:{y:{beginAtZero:!0}}}})}function updateCharts(){let t=[],e=[],a=0;for(let n=1;n<=5;n++){a+=calculationData.annualSavings*Math.pow(1+uipMetrics.yearlyGrowth,n-1),t.push(a),e.push(calculationData.annualInvestment*n)}savingsChart.data.datasets[0].data=t,savingsChart.data.datasets[1].data=e,savingsChart.update();const n=calculationData.weeklyManualHours,o=n*(1-uipMetrics.automationRate);comparisonChart.data.datasets[0].data=[100,n,100*calculationData.benchmark.errorRate,67],comparisonChart.data.datasets[1].data=[13,o,calculationData.benchmark.errorRate*(1-uipMetrics.errorReduction)*100,94],comparisonChart.update()}function updateBenchmarks(){const t=calculationData.annualDDCharges/(5e3*calculationData.totalContainers)*100,e=document.getElementById("yourDDRate"),a=Math.min(100,t/5*100);e.style.width=a+"%",e.querySelector(".benchmark-value").textContent=t.toFixed(1)+"%";const n=document.getElementById("yourProcessingTime"),o=Math.min(100,calculationData.weeklyManualHours/300*100);n.style.width=o+"%",n.querySelector(".benchmark-value").textContent=calculationData.weeklyManualHours+" hrs",e.style.backgroundColor=t>3?"#FF6B35":t>2?"#FFA500":"#00D4AA"}function handleFormSubmission(t){t.preventDefault();const e=new FormData(t.target);Object.fromEntries(e).calculationData=calculationData;const a=t.target.querySelector('button[type="submit"]'),n=a.textContent;a.textContent="Booking Your Call...",a.disabled=!0,setTimeout(()=>{a.textContent="✓ Call Booked!",a.style.backgroundColor="#00D4AA",setTimeout(()=>{a.textContent=n,a.disabled=!1,a.style.backgroundColor="",t.target.reset()},3e3)},1500),"undefined"!=typeof gtag&&gtag("event","conversion",{event_category:"ROI Calculator",event_label:"Strategy Call Booked",value:calculationData.annualSavings})}function generatePDFReport(){const{jsPDF:t}=window.jspdf,e=new t;e.setFontSize(20),e.setTextColor(10,22,40),e.text("UIP ROI Analysis Report",20,20),e.setFontSize(10),e.setTextColor(94,107,124),e.text((new Date).toLocaleDateString(),20,30),e.setFontSize(12),e.setTextColor(10,22,40);const a=document.getElementById("vesselCount").value;e.text(`Analysis for: ${a} Vessels Operation`,20,45),e.setFontSize(16),e.text("Executive Summary",20,60),e.setFontSize(12),e.setTextColor(0,212,170),e.text(`Total Annual Savings: $${(calculationData.annualSavings/1e6).toFixed(1)}M`,20,75),e.setTextColor(10,22,40),e.text(`ROI: ${calculationData.roi.toFixed(0)}%`,20,85),e.text(`Payback Period: ${calculationData.paybackDays.toFixed(0)} days`,20,95),e.text(`5-Year Value: $${(calculationData.fiveYearValue/1e6).toFixed(1)}M`,20,105),e.setFontSize(14),e.text("Savings Breakdown",20,125),e.setFontSize(11),e.text(`D&D Prevention: $${(calculationData.totalDDSavings/1e6).toFixed(1)}M`,30,140),e.text(`Labor Efficiency: $${(calculationData.laborSavings/1e3).toFixed(0)}K`,30,150),e.text(`Integration Gains: $${(calculationData.totalEfficiencyGains/1e3).toFixed(0)}K`,30,160),e.setFontSize(14),e.text("Implementation Timeline",20,180),e.setFontSize(11),e.text("• Day 1-3: API Integration & Data Mapping",30,195),e.text("• Day 4-7: Historical Data Analysis",30,205),e.text("• Day 8-10: Team Training & Testing",30,215),e.text("• Day 11-14: Go-Live & Optimization",30,225),e.setFontSize(10),e.setTextColor(94,107,124),e.text("This analysis is based on industry benchmarks and actual client results.",20,260),e.text("Contact UIP at sales@uip.com for a personalized consultation.",20,270),e.save(`UIP_ROI_Analysis_${(new Date).toISOString().split("T")[0]}.pdf`),"undefined"!=typeof gtag&&gtag("event","download",{event_category:"ROI Calculator",event_label:"PDF Report",value:calculationData.annualSavings})}function shareResults(){const t={title:"UIP ROI Calculator Results",text:`I could save $${(calculationData.annualSavings/1e6).toFixed(1)}M annually with UIP's ocean freight automation platform!`,url:window.location.href};if(navigator.share)navigator.share(t);else{const e=`${t.text} Check it out: ${t.url}`;navigator.clipboard.writeText(e).then(()=>{const t=document.getElementById("shareResults"),e=t.innerHTML;t.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/></svg> Copied!',setTimeout(()=>{t.innerHTML=e},2e3)})}}document.addEventListener("DOMContentLoaded",function(){initializeSliders(),initializeEventListeners(),initializeCharts(),calculateROI()});