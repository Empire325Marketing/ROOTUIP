class PresentationDeck{constructor(){this.currentSlide=1,this.totalSlides=20,this.presentationData={},this.isPresenting=!1,this.timer=null,this.startTime=null,this.charts={},this.animations={},this.init()}init(){this.loadPresentation(),this.setupEventListeners(),this.initializeCharts(),this.hideLoadingScreen()}hideLoadingScreen(){setTimeout(()=>{const e=document.getElementById("loadingScreen");e&&e.classList.add("hidden")},1500)}loadPresentation(){const e=localStorage.getItem("prospectName")||"",t=localStorage.getItem("vesselCount")||"50",n=localStorage.getItem("industryType")||"general",s=localStorage.getItem("annualRevenue")||"";this.presentationData={prospectName:e,vesselCount:parseInt(t),industryType:n,annualRevenue:s,annualSavings:14.2*parseInt(t),roiPercentage:347,implementationDays:2},this.updateSlideContent()}updateSlideContent(){if(this.presentationData.prospectName){document.querySelectorAll(".prospect-name").forEach(e=>{e.textContent=this.presentationData.prospectName})}document.querySelectorAll(".vessel-count").forEach(e=>{e.textContent=this.presentationData.vesselCount});document.querySelectorAll(".annual-savings").forEach(e=>{e.textContent=`$${this.presentationData.annualSavings.toFixed(1)}M`})}setupEventListeners(){document.querySelectorAll(".select-btn").forEach(e=>{e.addEventListener("click",t=>{const n=e.dataset.presentation;this.startPresentation(n)})});["prospectName","vesselCount","industryType","annualRevenue"].forEach(e=>{const t=document.getElementById(e);t&&t.addEventListener("change",t=>{localStorage.setItem(e,t.target.value),this.loadPresentation()})}),this.setupPresentationControls(),document.addEventListener("keydown",e=>this.handleKeyPress(e));const e=document.querySelector(".exit-presentation");e&&e.addEventListener("click",()=>this.exitPresentation())}setupPresentationControls(){const e=document.querySelector(".prev-slide"),t=document.querySelector(".next-slide");e&&e.addEventListener("click",()=>this.previousSlide()),t&&t.addEventListener("click",()=>this.nextSlide());document.querySelectorAll(".slide-thumbnail").forEach(e=>{e.addEventListener("click",()=>{const t=parseInt(e.dataset.slide);this.goToSlide(t)})});const n=document.querySelector(".play-pause"),s=document.querySelector(".fullscreen"),i=document.querySelector(".toggle-notes");n&&n.addEventListener("click",()=>this.toggleAutoPlay()),s&&s.addEventListener("click",()=>this.toggleFullscreen()),i&&i.addEventListener("click",()=>this.toggleNotes())}startPresentation(e){const t=document.getElementById("presentationDashboard"),n=document.getElementById("presentationViewer");t&&(t.style.display="none"),n&&(n.style.display="block"),this.isPresenting=!0,this.currentSlide=1,this.startTimer(),this.showSlide(1),this.loadPresentationType(e)}loadPresentationType(e){const t=document.getElementById("slidesContainer");if(t)if("master"!==e){if("undefined"!=typeof presentationTemplates&&presentationTemplates[e]){const n=presentationTemplates[e];this.totalSlides=n.slides.length,t.innerHTML="",n.slides.forEach((e,n)=>{const s=document.createElement("div");s.className="slide",s.setAttribute("data-slide",n+1),s.setAttribute("data-notes",e.notes||""),s.innerHTML=`\n                    <div class="slide-content">\n                        ${e.content}\n                    </div>\n                `,t.appendChild(s)});const s=document.querySelector(".presentation-title");s&&(s.textContent=n.title)}}else this.totalSlides=20}showSlide(e){document.querySelectorAll(".slide").forEach(e=>{e.classList.remove("active")});const t=document.querySelector(`[data-slide="${e}"]`);t&&(t.classList.add("active"),this.animateSlide(e),this.updateNavigation(e),this.updatePresenterNotes(e)),this.currentSlide=e}animateSlide(e){const t=document.querySelector(`[data-slide="${e}"]`);if(!t)return;t.querySelectorAll(".counter").forEach(e=>{const t=parseFloat(e.dataset.target),n=parseInt(e.dataset.decimals)||0;anime({targets:e,textContent:[0,t],duration:2e3,easing:"easeInOutExpo",round:0===n?1:Math.pow(10,n),update:function(t){n>0&&(e.textContent=parseFloat(e.textContent).toFixed(n))}})}),this.charts[`slide${e}`]&&this.charts[`slide${e}`].update(),anime({targets:t.querySelectorAll(".animate-in"),opacity:[0,1],translateY:[30,0],delay:anime.stagger(100),duration:800,easing:"easeOutCubic"})}updateNavigation(e){const t=document.querySelector(".slide-current"),n=document.querySelector(".slide-total");t&&(t.textContent=e),n&&(n.textContent=this.totalSlides);const s=e/this.totalSlides*100,i=document.querySelector(".slide-progress-fill");i&&(i.style.width=`${s}%`);document.querySelectorAll(".slide-thumbnail").forEach(t=>{t.classList.remove("active"),parseInt(t.dataset.slide)===e&&t.classList.add("active")});const a=document.querySelector(".prev-slide"),o=document.querySelector(".next-slide");a&&(a.disabled=1===e),o&&(o.disabled=e===this.totalSlides)}updatePresenterNotes(e){const t=document.querySelector(`[data-slide="${e}"]`),n=document.querySelector(".presenter-notes");if(t&&n){const e=t.dataset.notes||"No presenter notes for this slide.";n.querySelector(".notes-content").textContent=e}}previousSlide(){this.currentSlide>1&&this.showSlide(this.currentSlide-1)}nextSlide(){this.currentSlide<this.totalSlides&&this.showSlide(this.currentSlide+1)}goToSlide(e){e>=1&&e<=this.totalSlides&&this.showSlide(e)}handleKeyPress(e){if(this.isPresenting)switch(e.key){case"ArrowLeft":this.previousSlide();break;case"ArrowRight":case" ":this.nextSlide();break;case"Escape":this.exitPresentation();break;case"f":this.toggleFullscreen();break;case"n":this.toggleNotes()}}toggleAutoPlay(){const e=document.querySelector(".play-pause");e.classList.contains("playing")?(clearInterval(this.autoPlayInterval),e.classList.remove("playing"),e.innerHTML="▶"):(this.autoPlayInterval=setInterval(()=>{this.currentSlide<this.totalSlides?this.nextSlide():this.toggleAutoPlay()},5e3),e.classList.add("playing"),e.innerHTML="⏸")}toggleFullscreen(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}toggleNotes(){const e=document.querySelector(".presenter-notes");e&&e.classList.toggle("hidden")}startTimer(){this.startTime=Date.now(),this.updateTimer(),this.timerInterval=setInterval(()=>{this.updateTimer()},1e3)}updateTimer(){const e=Math.floor((Date.now()-this.startTime)/1e3),t=Math.floor(e/60),n=e%60,s=document.querySelector(".presentation-timer");s&&(s.textContent=`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`)}exitPresentation(){this.timerInterval&&clearInterval(this.timerInterval),this.autoPlayInterval&&clearInterval(this.autoPlayInterval);const e=document.getElementById("presentationDashboard"),t=document.getElementById("presentationViewer");e&&(e.style.display="block"),t&&(t.style.display="none"),this.isPresenting=!1,document.fullscreenElement&&document.exitFullscreen()}initializeCharts(){this.initMarketSizeChart(),this.initSavingsChart(),this.initCompetitionChart(),this.initFinancialsChart()}initMarketSizeChart(){const e=document.getElementById("marketSizeChart");if(!e)return;const t=e.getContext("2d");this.charts.slide5=new Chart(t,{type:"bar",data:{labels:["D&D Charges","Port Congestion","Documentation","Other"],datasets:[{label:"Market Size ($B)",data:[8,6,2.5,2.5],backgroundColor:"#00D4AA",borderRadius:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return"$"+e+"B"}}}}}})}initSavingsChart(){const e=document.getElementById("savingsChart");if(!e)return;const t=e.getContext("2d"),n=this.presentationData.vesselCount;this.charts.slide7=new Chart(t,{type:"line",data:{labels:["Month 1","Month 3","Month 6","Month 12","Month 18"],datasets:[{label:"Cumulative Savings",data:[1.2*n,3.5*n,7.1*n,14.2*n,21.3*n],borderColor:"#00D4AA",backgroundColor:"rgba(0, 212, 170, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return"$"+e+"M"}}}}}})}initCompetitionChart(){const e=document.getElementById("competitionChart");if(!e)return;const t=e.getContext("2d");this.charts.slide12=new Chart(t,{type:"radar",data:{labels:["Universal Integration","AI Automation","Predictive Analytics","Dispute Success","Implementation Speed","ROI"],datasets:[{label:"UIP",data:[100,95,98,94,95,100],borderColor:"#00D4AA",backgroundColor:"rgba(0, 212, 170, 0.2)"},{label:"Traditional Solutions",data:[30,20,15,67,20,40],borderColor:"#FF6B6B",backgroundColor:"rgba(255, 107, 107, 0.2)"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{r:{beginAtZero:!0,max:100}}}})}initFinancialsChart(){const e=document.getElementById("financialsChart");if(!e)return;const t=e.getContext("2d");this.charts.slide16=new Chart(t,{type:"bar",data:{labels:["2023","2024","2025","2026","2027"],datasets:[{label:"Revenue ($M)",data:[12,48,125,280,520],backgroundColor:"#00D4AA",borderRadius:8,yAxisID:"y"},{label:"ARR Growth %",data:[0,300,160,124,86],type:"line",borderColor:"#0066FF",backgroundColor:"transparent",yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{y:{type:"linear",display:!0,position:"left",ticks:{callback:function(e){return"$"+e+"M"}}},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1},ticks:{callback:function(e){return e+"%"}}}}}})}exportToPDF(){console.log("Exporting to PDF..."),alert("PDF export functionality would be implemented here")}exportToPowerPoint(){console.log("Exporting to PowerPoint..."),alert("PowerPoint export functionality would be implemented here")}}document.addEventListener("DOMContentLoaded",()=>{new PresentationDeck});