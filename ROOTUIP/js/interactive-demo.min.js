const demoState={currentRole:null,currentView:"dashboard",tourActive:!1,tourStep:0,analytics:{startTime:Date.now(),interactions:[],viewedSections:new Set,roleSelected:null}},tourSteps={executive:[{element:'.kpi-card[data-tooltip*="D&D"]',title:"Real-Time Savings Tracking",text:"See exactly how much you're saving on D&D charges. This month alone, you've prevented $1.4M in unnecessary fees.",position:"bottom"},{element:".risk-analysis",title:"Predictive Risk Analysis",text:"Our AI analyzes patterns to predict D&D risks up to 14 days in advance, giving you time to prevent charges.",position:"top"},{element:".alerts-panel",title:"Automated Exception Handling",text:"Critical issues are automatically detected and resolved. Your team only deals with true exceptions.",position:"left"},{element:'.demo-tab[data-view="tracking"]',title:"Live Container Tracking",text:"Track all your containers across carriers in real-time. Click to see the live tracking view.",position:"bottom",action:"click"}],operations:[{element:".alerts-panel",title:"Your Daily Workflow Simplified",text:"Start your day with prioritized alerts. UIP handles routine tasks so you can focus on exceptions.",position:"left"},{element:'.demo-tab[data-view="prevention"]',title:"Automated D&D Prevention",text:"See how UIP automatically prevents charges before they occur. Click to explore the workflow.",position:"bottom",action:"click"},{element:".workflow-timeline",title:"Intelligent Automation",text:"Each step is automated based on your business rules. Manual intervention only when needed.",position:"right"}],it:[{element:'.demo-tab[data-view="integrations"]',title:"Seamless Integration",text:"UIP connects to your existing systems without disruption. Click to see live integration status.",position:"bottom",action:"click"},{element:".integration-card",title:"Real-Time Data Flow",text:"Monitor data flow and system health in real-time. 99.9% uptime guaranteed.",position:"right"},{element:'.demo-tab[data-view="documents"]',title:"Intelligent Document Processing",text:"See how AI processes documents 900x faster than manual entry.",position:"bottom",action:"click"}]};function initializeRoleSelection(){const e=document.querySelectorAll(".role-select-btn"),t=document.getElementById("skipTour");e.forEach(e=>{e.addEventListener("click",function(){selectRole(this.getAttribute("data-role"),!0)})}),t.addEventListener("click",function(){selectRole("explorer",!1)})}function selectRole(e,t){demoState.currentRole=e,demoState.analytics.roleSelected=e,document.getElementById("userRole").textContent=getRoleTitle(e),document.querySelector(".role-selection").classList.remove("active"),document.querySelector(".demo-interface").classList.add("active"),trackAnalytics("role_selected",{role:e}),t&&tourSteps[e]&&setTimeout(()=>startGuidedTour(e),500),customizeForRole(e)}function getRoleTitle(e){return{executive:"Executive View",operations:"Operations View",it:"IT/Technical View",explorer:"Explorer Mode"}[e]||"Demo Mode"}function customizeForRole(e){"executive"===e?document.querySelectorAll(".technical-detail").forEach(e=>e.style.display="none"):"operations"===e?switchView("prevention"):"it"===e&&switchView("integrations")}function startGuidedTour(e){const t=tourSteps[e];t&&0!==t.length&&(demoState.tourActive=!0,demoState.tourStep=0,document.getElementById("tourOverlay").classList.add("active"),document.getElementById("tourTotal").textContent=t.length,showTourStep(t[0],1))}function showTourStep(e,t){const o=document.querySelector(e.element);if(!o)return;const n=document.getElementById("tourHighlight"),i=document.getElementById("tourTooltip"),a=o.getBoundingClientRect();n.style.top=a.top-5+"px",n.style.left=a.left-5+"px",n.style.width=a.width+10+"px",n.style.height=a.height+10+"px",positionTooltip(i,a,e.position),document.getElementById("tooltipTitle").textContent=e.title,document.getElementById("tooltipText").textContent=e.text,document.getElementById("tourStep").textContent=t,"click"===e.action&&o.addEventListener("click",handleTourAction,{once:!0})}function positionTooltip(e,t,o){const n=e.getBoundingClientRect();let i,a;switch(o){case"bottom":i=t.bottom+10,a=t.left+(t.width-n.width)/2;break;case"top":i=t.top-n.height-10,a=t.left+(t.width-n.width)/2;break;case"left":i=t.top+(t.height-n.height)/2,a=t.left-n.width-10;break;case"right":i=t.top+(t.height-n.height)/2,a=t.right+10}i=Math.max(10,Math.min(i,window.innerHeight-n.height-10)),a=Math.max(10,Math.min(a,window.innerWidth-n.width-10)),e.style.top=i+"px",e.style.left=a+"px"}function handleTourAction(){setTimeout(()=>nextTourStep(),1e3)}function nextTourStep(){const e=demoState.currentRole,t=tourSteps[e];demoState.tourStep++,demoState.tourStep>=t.length?endTour():showTourStep(t[demoState.tourStep],demoState.tourStep+1)}function endTour(){demoState.tourActive=!1,document.getElementById("tourOverlay").classList.remove("active"),trackAnalytics("tour_completed",{role:demoState.currentRole}),setTimeout(()=>{document.getElementById("ctaSidebar").classList.add("active")},1e3)}function initializeDemoInterface(){document.querySelectorAll(".demo-tab").forEach(e=>{e.addEventListener("click",function(){switchView(this.getAttribute("data-view"))})}),document.getElementById("demoHelp").addEventListener("click",function(){demoState.currentRole&&tourSteps[demoState.currentRole]&&startGuidedTour(demoState.currentRole)}),document.getElementById("demoExit").addEventListener("click",showExitModal),document.getElementById("nextStepBtn").addEventListener("click",nextTourStep),document.getElementById("skipTourBtn").addEventListener("click",endTour)}function switchView(e){document.querySelectorAll(".demo-tab").forEach(t=>{t.classList.toggle("active",t.getAttribute("data-view")===e)}),document.querySelectorAll(".demo-view").forEach(t=>{t.classList.toggle("active",t.id===e+"View")}),demoState.currentView=e,demoState.analytics.viewedSections.add(e),trackAnalytics("view_changed",{view:e}),initializeViewFeatures(e)}function initializeViewFeatures(e){switch(e){case"tracking":initializeTrackingMap(),animateVesselMovement();break;case"prevention":startPreventionAnimation();break;case"documents":startDocumentProcessing();break;case"disputes":setupDisputeDemo()}}function initializeCharts(){const e=document.getElementById("ddSparkline");e&&new Chart(e.getContext("2d"),{type:"line",data:{labels:Array.from({length:30},(e,t)=>t+1),datasets:[{data:generateSparklineData(),borderColor:"#00D4AA",borderWidth:2,fill:!1,tension:.4,pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{display:!1},y:{display:!1}}}});const t=document.getElementById("riskChart");t&&new Chart(t.getContext("2d"),{type:"bar",data:{labels:["Day 1","Day 2","Day 3","Day 4","Day 5","Day 6","Day 7"],datasets:[{label:"High Risk",data:[2,3,1,4,2,3,5],backgroundColor:"#FF6B35"},{label:"Medium Risk",data:[5,8,6,9,7,6,8],backgroundColor:"#FFA500"},{label:"Low Risk",data:[15,12,18,14,16,20,17],backgroundColor:"#00D4AA"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{stacked:!0},y:{stacked:!0}}}})}function generateSparklineData(){return Array.from({length:30},()=>12e5+4e5*Math.random()-2e5)}function initializeTrackingMap(){mapboxgl.accessToken="pk.eyJ1IjoiZGVtby11aXAiLCJhIjoiY2xwMHZ3NGRmMDRmYTJrcXN5ZHB6OHVzNyJ9.demo";const e=new mapboxgl.Map({container:"trackingMap",style:"mapbox://styles/mapbox/dark-v10",center:[-118.2437,34.0522],zoom:3});[{id:"msc-geneva",coords:[-140,35],name:"MSC GENEVA",status:"delayed"},{id:"ever-given",coords:[-73.5,40.7],name:"EVER GIVEN",status:"on-time"}].forEach(t=>{const o=document.createElement("div");o.className=`vessel-marker ${t.status}`,new mapboxgl.Marker(o).setLngLat(t.coords).setPopup((new mapboxgl.Popup).setHTML(`<h4>${t.name}</h4>\n                 <p>Status: ${t.status}</p>`)).addTo(e)}),e.on("load",()=>{e.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[121.4737,31.2304],[-140,35],[-118.2437,34.0522]]}}}),e.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#FF6B35","line-width":3,"line-dasharray":[2,2]}})})}function animateVesselMovement(){const e=document.querySelectorAll(".vessel-item");e.forEach(t=>{t.addEventListener("click",function(){e.forEach(e=>e.classList.remove("active")),this.classList.add("active");this.getAttribute("data-vessel");const t=document.getElementById("vesselPopup");t.style.display="block",setTimeout(()=>t.classList.add("visible"),100)})})}function startPreventionAnimation(){const e=document.querySelectorAll(".workflow-step");let t=0;!function o(){if(t>0&&e[t-1].classList.remove("active"),t<e.length){e[t].classList.add("active");const n=e[t].querySelector(".step-demo");n&&animateStepContent(n),t++,setTimeout(o,3e3)}else t=0,setTimeout(o,2e3)}()}function animateStepContent(e){e.querySelectorAll(".detection-item, .action-item, .notif-item").forEach((e,t)=>{setTimeout(()=>{e.classList.add("animate")},500*t)})}function startDocumentProcessing(){const e=document.querySelectorAll(".manual-process .process-step"),t=document.querySelectorAll(".automated-process .process-step");e.forEach((e,t)=>{setTimeout(()=>{e.classList.add("active")},1500*t)}),setTimeout(()=>{t.forEach((e,t)=>{setTimeout(()=>{e.classList.add("completed")},200*t)})},2e3),simulateDocumentStream()}function simulateDocumentStream(){const e=document.querySelector(".doc-item.processing");if(!e)return;const t=e.querySelector(".progress-fill");let o=0;const n=setInterval(()=>{o+=10,t.style.width=o+"%",o>=100&&(clearInterval(n),e.classList.remove("processing"),e.classList.add("completed"),setTimeout(()=>{createNewProcessingDoc()},2e3))},200)}function createNewProcessingDoc(){const e=document.querySelector(".document-stream"),t=document.createElement("div");t.className="doc-item processing",t.innerHTML=`\n        <div class="doc-icon">ðŸ“„</div>\n        <div class="doc-info">\n            <div class="doc-name">EVERGREEN_B/L_${Math.floor(1e5*Math.random())}.pdf</div>\n            <div class="doc-status">Processing...</div>\n        </div>\n        <div class="doc-progress">\n            <div class="progress-bar">\n                <div class="progress-fill" style="width: 0%"></div>\n            </div>\n        </div>\n    `,e.insertBefore(t,e.firstChild),setTimeout(()=>simulateDocumentStream(),500)}function updateIntegrationMetrics(){setInterval(()=>{document.querySelectorAll(".integration-card .metric-value").forEach(e=>{const t=parseInt(e.textContent),o=10*Math.random()-5,n=Math.max(0,t+Math.floor(t*o/100));e.textContent=n.toLocaleString()})},3e3)}function setupDisputeDemo(){document.getElementById("startDisputeDemo").addEventListener("click",startDisputeDemo)}function startDisputeDemo(){const e=document.querySelectorAll(".dispute-stage");let t=0;e.forEach(e=>{e.classList.remove("active","complete")}),function o(){if(t>0&&(e[t-1].classList.remove("active"),e[t-1].classList.add("complete")),t<e.length){switch(e[t].classList.add("active"),t){case 1:animateAnalysis();break;case 2:prepareDispute();break;case 3:showResolution()}t++,setTimeout(o,3e3)}}()}function animateAnalysis(){document.querySelectorAll(".analysis-item").forEach((e,t)=>{setTimeout(()=>{e.classList.add("complete")},500*t)})}function prepareDispute(){document.querySelector(".file-dispute-btn").addEventListener("click",function(){this.textContent="Filing...",this.disabled=!0,setTimeout(()=>{this.textContent="âœ“ Filed",this.style.backgroundColor="#00D4AA"},1500)})}function showResolution(){document.querySelector(".resolution-success").classList.add("animate")}function setupCTASidebar(){const e=document.getElementById("ctaToggle"),t=document.getElementById("ctaSidebar");e.addEventListener("click",function(){t.classList.toggle("expanded")}),document.getElementById("bookLiveDemo").addEventListener("click",function(){trackAnalytics("demo_cta_clicked",{type:"book_demo"}),window.location.href="/book-demo"})}function showExitModal(){document.getElementById("exitModal").classList.add("active"),trackAnalytics("exit_intent_shown")}function setupExitModal(){document.getElementById("closeExitModal").addEventListener("click",function(){document.getElementById("exitModal").classList.remove("active")}),document.getElementById("scheduleDemoExit").addEventListener("click",function(){trackAnalytics("exit_cta_clicked",{type:"schedule_demo"}),window.location.href="/book-demo"}),document.getElementById("downloadGuideExit").addEventListener("click",function(){trackAnalytics("exit_cta_clicked",{type:"download_guide"})})}function setupEventListeners(){updateIntegrationMetrics(),setupCTASidebar(),setupExitModal(),window.addEventListener("beforeunload",function(){trackAnalytics("demo_session_end",{timeSpent:Date.now()-demoState.analytics.startTime,viewedSections:Array.from(demoState.analytics.viewedSections),interactions:demoState.analytics.interactions.length})})}function trackAnalytics(e,t={}){demoState.analytics.interactions.push({event:e,data:t,timestamp:Date.now()}),"undefined"!=typeof gtag&&gtag("event",e,{event_category:"Interactive Demo",...t}),console.log("Analytics:",e,t)}function animateValue(e,t,o,n){const i=(o-t)/(n/16);let a=t;const s=setInterval(()=>{a+=i,(i>0&&a>=o||i<0&&a<=o)&&(a=o,clearInterval(s)),e.textContent=formatValue(a)},16)}function formatValue(e){return e>=1e6?"$"+(e/1e6).toFixed(1)+"M":e>=1e3?"$"+(e/1e3).toFixed(0)+"K":"$"+Math.round(e)}document.addEventListener("DOMContentLoaded",function(){initializeRoleSelection(),initializeDemoInterface(),initializeCharts(),setupEventListeners(),trackAnalytics("demo_loaded")});