let currentPresentation=null,revealInstance=null,presentationData={vesselCount:50,companyName:"Your Company",primaryColor:"#0A1628",accentColor:"#00D4AA"};function initializePresentationSelector(){document.querySelectorAll(".select-presentation").forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-type");if("vertical"===e){const e=document.getElementById("verticalSelect");if(!e.value)return void alert("Please select an industry first");loadPresentation("vertical-"+e.value)}else loadPresentation(e)})});document.getElementById("verticalSelect").addEventListener("change",function(){const e=document.querySelector('.select-presentation[data-type="vertical"]');this.value?(e.disabled=!1,e.textContent=`Launch ${this.options[this.selectedIndex].text} Presentation`):(e.disabled=!0,e.textContent="Select Industry First")})}function loadPresentation(e){currentPresentation=e,document.getElementById("presentationSelector").style.display="none",document.getElementById("presentationContainer").style.display="block",hideAllSlides(),showPresentationSlides(e),initializeReveal(),document.getElementById("presentationControls").style.display="flex",setTimeout(()=>{initializeCharts(),initializeAnimations()},500)}function hideAllSlides(){document.querySelectorAll(".reveal .slides > section").forEach(e=>{e.style.display="none"})}function showPresentationSlides(e){let t="";switch(e){case"master-pitch":t="#masterPitchDeck";break;case"executive-15":t="#executive15";break;case"technical-30":t="#technical30";break;case"demo-45":t="#demo45";break;case"cfo-roi":t="#cfoRoi";break;case"vertical-retail":case"vertical-manufacturing":case"vertical-food":case"vertical-automotive":loadVerticalContent(e.split("-")[1]),t="#verticalPresentation"}if(t){const e=document.querySelector(t);e&&(e.style.display="block")}}function initializeReveal(){revealInstance&&revealInstance.destroy(),revealInstance=new Reveal({hash:!0,controls:!1,progress:!0,center:!1,transition:"slide",backgroundTransition:"fade",parallaxBackgroundImage:"",parallaxBackgroundSize:"",parallaxBackgroundHorizontal:null,parallaxBackgroundVertical:null}),revealInstance.initialize(),revealInstance.on("slidechanged",updateSlideCounter),updateSlideCounter()}function updateSlideCounter(){if(!revealInstance)return;const e=revealInstance.getIndices(),t=revealInstance.getTotalSlides();document.getElementById("currentSlide").textContent=e.h+1,document.getElementById("totalSlides").textContent=t}function initializeCharts(){const e=document.getElementById("problemChart");e&&new Chart(e.getContext("2d"),{type:"doughnut",data:{labels:["D&D Charges","Manual Processing","Integration Errors","Other"],datasets:[{data:[35,40,20,5],backgroundColor:["#FF6B35","#FFA500","#FFD700","#E2E8F0"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},tooltip:{callbacks:{label:function(e){return e.label+": $"+(.2*e.parsed).toFixed(1)+"B"}}}}}});const t=document.getElementById("marketChart");t&&new Chart(t.getContext("2d"),{type:"bar",data:{labels:["TAM","SAM","SOM Year 1","SOM Year 3","SOM Year 5"],datasets:[{label:"Market Opportunity ($B)",data:[72,24,.5,4.2,12.5],backgroundColor:"#00D4AA",borderColor:"#00B894",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return"$"+e+"B"}}}}}});const n=document.getElementById("competitionChart");n&&new Chart(n.getContext("2d"),{type:"scatter",data:{datasets:[{label:"UIP",data:[{x:14,y:87}],backgroundColor:"#00D4AA",pointRadius:15},{label:"Legacy TMS",data:[{x:180,y:20}],backgroundColor:"#FF6B35",pointRadius:10},{label:"Freight Forwarders",data:[{x:90,y:40}],backgroundColor:"#FFA500",pointRadius:10},{label:"In-House Solutions",data:[{x:365,y:15}],backgroundColor:"#94A3B8",pointRadius:10}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Implementation Time (Days)"}},y:{title:{display:!0,text:"D&D Prevention Rate (%)"}}}}});const a=document.getElementById("financialProjections");a&&new Chart(a.getContext("2d"),{type:"line",data:{labels:["2024","2025","2026","2027","2028"],datasets:[{label:"ARR ($M)",data:[12,48,156,420,980],borderColor:"#00D4AA",backgroundColor:"rgba(0, 212, 170, 0.1)",borderWidth:3,tension:.4,fill:!0},{label:"Expenses ($M)",data:[8,32,89,210,441],borderColor:"#FF6B35",borderWidth:2,borderDash:[5,5]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return"$"+e+"M"}}}}}});const o=document.getElementById("cohortChart");o&&new Chart(o.getContext("2d"),{type:"line",data:{labels:["Month 0","Month 6","Month 12","Month 18","Month 24"],datasets:[{label:"2023 Cohort",data:[100,100,100,100,100],borderColor:"#00D4AA",borderWidth:3},{label:"2022 Cohort",data:[100,100,100,100,100],borderColor:"#0066FF",borderWidth:3},{label:"Industry Average",data:[100,88,76,65,54],borderColor:"#FF6B35",borderWidth:2,borderDash:[5,5]}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:110,ticks:{callback:function(e){return e+"%"}}}}}})}function initializeAnimations(){animateCounters(),animateTimelineSteps(),animateProcessSteps()}function animateCounters(){document.querySelectorAll("[data-counter]").forEach(e=>{const t=parseInt(e.getAttribute("data-counter")),n=t/125;let a=0;const o=()=>{a+=n,a>=t?(a=t,e.textContent=formatCounter(a,e)):(e.textContent=formatCounter(a,e),requestAnimationFrame(o))},r=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(o(),r.unobserve(e.target))})});r.observe(e)})}function formatCounter(e,t){const n=t.textContent;return n.includes("$")?"$"+Math.round(e)+n.match(/[A-Z]/)[0]:n.includes("%")?Math.round(e)+"%":Math.round(e).toString()}function animateTimelineSteps(){document.querySelectorAll(".timeline-step").forEach((e,t)=>{e.style.opacity="0",e.style.transform="translateY(20px)",setTimeout(()=>{e.style.transition="all 0.5s ease",e.style.opacity="1",e.style.transform="translateY(0)"},200*t)})}function animateProcessSteps(){document.querySelectorAll(".process-step").forEach((e,t)=>{const n=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(setTimeout(()=>{e.target.classList.add("animate")},300*t),n.unobserve(e.target))})});n.observe(e)})}function setupEventListeners(){document.getElementById("prevSlide").addEventListener("click",()=>{revealInstance&&revealInstance.prev()}),document.getElementById("nextSlide").addEventListener("click",()=>{revealInstance&&revealInstance.next()}),document.getElementById("fullscreenToggle").addEventListener("click",toggleFullscreen),document.getElementById("exitPresentation").addEventListener("click",exitPresentation),document.addEventListener("keydown",handleKeyboard),document.getElementById("downloadAll").addEventListener("click",downloadAllTemplates),document.getElementById("customizeTheme").addEventListener("click",()=>{document.getElementById("themeCustomizer").classList.add("active")})}function handleKeyboard(e){if(revealInstance)switch(e.key){case"Escape":document.fullscreenElement?document.exitFullscreen():exitPresentation();break;case"f":case"F":toggleFullscreen()}}function toggleFullscreen(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}function exitPresentation(){confirm("Exit presentation?")&&(revealInstance&&(revealInstance.destroy(),revealInstance=null),document.getElementById("presentationContainer").style.display="none",document.getElementById("presentationSelector").style.display="flex",document.getElementById("presentationControls").style.display="none",currentPresentation=null)}function initializeCustomizer(){document.getElementById("closeCustomizer").addEventListener("click",()=>{document.getElementById("themeCustomizer").classList.remove("active")}),document.getElementById("applyCustomization").addEventListener("click",applyCustomization)}function applyCustomization(){presentationData.primaryColor=document.getElementById("primaryColor").value,presentationData.accentColor=document.getElementById("accentColor").value,presentationData.companyName=document.getElementById("companyName").value||"Your Company",presentationData.vesselCount=parseInt(document.getElementById("vesselCount").value)||50,document.documentElement.style.setProperty("--custom-primary",presentationData.primaryColor),document.documentElement.style.setProperty("--custom-accent",presentationData.accentColor),updateVesselCalculations(),document.getElementById("themeCustomizer").classList.remove("active"),showNotification("Customization applied successfully!")}function updateVesselCalculations(){const e=presentationData.vesselCount;document.querySelectorAll(".your-numbers h3").forEach(t=>{t.textContent.includes("Vessels")&&(t.textContent=`For Your ${e} Vessels:`)});document.querySelectorAll(".value").forEach(e=>{})}function downloadAllTemplates(){showNotification("Preparing download package..."),setTimeout(()=>{showNotification("Download package ready! Check your downloads folder.")},2e3)}function loadVerticalContent(e){}function showNotification(e){const t=document.createElement("div");t.className="notification",t.textContent=e,t.style.cssText="\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        padding: 1rem 2rem;\n        background: var(--uip-teal-500);\n        color: white;\n        border-radius: 8px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n        z-index: 1000;\n        animation: slideIn 0.3s ease;\n    ",document.body.appendChild(t),setTimeout(()=>{t.style.animation="slideOut 0.3s ease",setTimeout(()=>t.remove(),300)},3e3)}document.addEventListener("DOMContentLoaded",function(){initializePresentationSelector(),initializeCustomizer(),setupEventListeners()});const style=document.createElement("style");style.textContent="\n    @keyframes slideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n    }\n    \n    @keyframes slideOut {\n        from { transform: translateX(0); opacity: 1; }\n        to { transform: translateX(100%); opacity: 0; }\n    }\n    \n    .process-step.animate {\n        animation: fadeInUp 0.5s ease forwards;\n    }\n    \n    @keyframes fadeInUp {\n        from { opacity: 0; transform: translateY(20px); }\n        to { opacity: 1; transform: translateY(0); }\n    }\n",document.head.appendChild(style);